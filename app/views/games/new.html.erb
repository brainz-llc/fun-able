<div class="min-h-screen py-8 px-4">
  <div class="max-w-2xl mx-auto">

    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl md:text-4xl font-black text-white mb-2"><%= t('home.create_game') %></h1>
      <p class="text-white/50">Configura tu partida y invita a tus amigos</p>
    </div>

    <%= form_with model: @game, url: games_path, method: :post, class: "space-y-8" do |f| %>

      <!-- Deck Selection -->
      <div>
        <label class="block text-sm font-medium text-white/70 mb-3 uppercase tracking-wide">
          <%= t('game.lobby.select_deck') %>
        </label>
        <div class="space-y-2 max-h-72 overflow-y-auto pr-1 custom-scrollbar">
          <% @decks.each do |deck| %>
            <label class="group flex items-center gap-4 p-4 rounded-xl cursor-pointer transition-all duration-200
                          border border-white/10 hover:border-pink-500/50 hover:bg-white/5
                          has-[:checked]:border-pink-500 has-[:checked]:bg-pink-500/10">
              <%= f.radio_button :deck_id, deck.id, class: "hidden peer" %>

              <!-- Radio indicator -->
              <div class="w-5 h-5 rounded-full border-2 border-white/30 group-hover:border-pink-500/50
                          peer-checked:group-[]:border-pink-500 peer-checked:group-[]:bg-pink-500
                          flex items-center justify-center transition-all">
                <div class="w-2 h-2 rounded-full bg-white scale-0 peer-checked:group-[]:scale-100 transition-transform"></div>
              </div>

              <!-- Deck info -->
              <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2 mb-1">
                  <span class="font-semibold text-white truncate"><%= deck.name %></span>
                  <% if deck.official? %>
                    <span class="text-[10px] px-2 py-0.5 rounded-full bg-pink-500/20 text-pink-400 border border-pink-500/30">
                      <%= t('deck.official') %>
                    </span>
                  <% end %>
                </div>
                <div class="flex items-center gap-3 text-sm">
                  <span class="text-pink-400"><%= deck.black_cards_count %> negras</span>
                  <span class="text-cyan-400"><%= deck.white_cards_count %> blancas</span>
                  <% if deck.region %>
                    <span class="text-white/40"><%= deck.region.display_name %></span>
                  <% end %>
                </div>
              </div>

              <!-- Rating badge -->
              <span class="rating-<%= deck.content_rating %> px-2 py-1 rounded-lg text-xs font-medium shrink-0">
                <%= t("deck.content_rating.#{deck.content_rating}") %>
              </span>
            </label>
          <% end %>
        </div>
      </div>

      <!-- Game Settings -->
      <div>
        <label class="block text-sm font-medium text-white/70 mb-3 uppercase tracking-wide">
          Configuracion
        </label>
        <div class="grid grid-cols-3 gap-3">
          <!-- Points to win -->
          <div class="p-4 rounded-xl bg-white/5 border border-white/10">
            <label class="block text-xs text-white/50 mb-2 text-center">Puntos</label>
            <%= f.number_field :points_to_win, min: 3, max: 20,
                class: "w-full bg-transparent text-center text-2xl font-bold text-white focus:outline-none" %>
          </div>

          <!-- Turn timer -->
          <div class="p-4 rounded-xl bg-white/5 border border-white/10">
            <label class="block text-xs text-white/50 mb-2 text-center">Segundos</label>
            <%= f.number_field :turn_timer, min: 30, max: 180, step: 10,
                class: "w-full bg-transparent text-center text-2xl font-bold text-white focus:outline-none" %>
          </div>

          <!-- Max players -->
          <div class="p-4 rounded-xl bg-white/5 border border-white/10">
            <label class="block text-xs text-white/50 mb-2 text-center">Jugadores</label>
            <%= f.number_field :max_players, min: 3, max: 20,
                class: "w-full bg-transparent text-center text-2xl font-bold text-white focus:outline-none" %>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex gap-3 pt-4">
        <%= link_to t('actions.cancel'), root_path,
            class: "flex-1 text-center py-4 rounded-xl font-medium text-white/60 hover:text-white
                    border border-white/10 hover:border-white/20 hover:bg-white/5 transition-all" %>

        <!-- Mobile: Neon button -->
        <%= f.submit t('home.create_game'),
            class: "md:hidden flex-1 py-4 rounded-xl font-bold text-white bg-pink-500
                    cursor-pointer transition-all active:scale-[0.98]",
            style: "box-shadow: 0 0 30px rgba(236, 72, 153, 0.4);" %>

        <!-- Desktop: Simple button -->
        <%= f.submit t('home.create_game'),
            class: "hidden md:block flex-1 py-4 rounded-xl font-bold text-white bg-pink-500
                    hover:bg-pink-400 cursor-pointer transition-all" %>
      </div>
    <% end %>

  </div>
</div>

<style>
  .custom-scrollbar::-webkit-scrollbar {
    width: 4px;
  }
  .custom-scrollbar::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 10px;
  }
  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 10px;
  }
  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.3);
  }

  /* Fix for has-[:checked] support */
  label:has(input:checked) {
    border-color: rgb(236 72 153);
    background: rgba(236, 72, 153, 0.1);
  }
  label:has(input:checked) .peer-checked\:group-\[\]\:border-pink-500 {
    border-color: rgb(236 72 153);
    background: rgb(236 72 153);
  }
  label:has(input:checked) .peer-checked\:group-\[\]\:scale-100 {
    transform: scale(1);
  }
</style>

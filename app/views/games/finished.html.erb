<div class="max-w-2xl mx-auto text-center py-12 tokyo-street-bg min-h-screen relative overflow-hidden" data-controller="victory">
  <!-- Animated background particles -->
  <div class="absolute inset-0 pointer-events-none">
    <div class="absolute top-10 left-10 w-3 h-3 rounded-full animate-ping" style="background: #ff2d95; box-shadow: 0 0 20px #ff2d95;"></div>
    <div class="absolute top-20 right-20 w-2 h-2 rounded-full animate-ping" style="background: #00f5ff; box-shadow: 0 0 15px #00f5ff; animation-delay: 0.3s;"></div>
    <div class="absolute top-1/3 left-5 w-2 h-2 rounded-full animate-ping" style="background: #bf00ff; box-shadow: 0 0 15px #bf00ff; animation-delay: 0.6s;"></div>
    <div class="absolute top-1/2 right-10 w-3 h-3 rounded-full animate-ping" style="background: #ff2d95; box-shadow: 0 0 20px #ff2d95; animation-delay: 0.9s;"></div>
    <div class="absolute bottom-1/3 left-20 w-2 h-2 rounded-full animate-ping" style="background: #00f5ff; box-shadow: 0 0 15px #00f5ff; animation-delay: 1.2s;"></div>
    <div class="absolute bottom-20 right-1/4 w-2 h-2 rounded-full animate-ping" style="background: #bf00ff; box-shadow: 0 0 15px #bf00ff; animation-delay: 1.5s;"></div>
  </div>

  <!-- Victory Header -->
  <div class="mb-10 relative">
    <!-- Glowing trophy -->
    <div class="text-8xl mb-6 animate-bounce-in"
         style="filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.8)) drop-shadow(0 0 60px rgba(255, 45, 149, 0.5));">
      &#x1F3C6;
    </div>

    <h1 class="text-5xl font-black mb-4 animate-neon-flicker"
        style="color: #ff2d95;
               text-shadow: 0 0 10px #ff2d95,
                            0 0 20px #ff2d95,
                            0 0 40px #ff2d95,
                            0 0 80px #ff2d95;">
      Partida Terminada!
    </h1>

    <% if current_game.winner %>
      <div class="relative inline-block">
        <div class="absolute inset-0 bg-gradient-to-r from-pink-500/20 via-purple-500/20 to-cyan-500/20 blur-2xl rounded-3xl"></div>
        <div class="relative px-8 py-4 rounded-2xl"
             style="background: linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, rgba(20, 0, 30, 0.9) 100%);
                    border: 2px solid #00f5ff;
                    box-shadow: 0 0 20px rgba(0, 245, 255, 0.5), 0 0 40px rgba(0, 245, 255, 0.3);">
          <p class="text-3xl font-bold neon-cyan animate-neon-pulse">
            <%= t('game.winner.game_winner', name: current_game.winner.display_name) %>
          </p>
          <p class="neon-purple text-lg mt-2">
            <%= t('game.winner.points', count: current_game.winner.score) %>
          </p>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Final Leaderboard -->
  <div class="rounded-2xl p-8 mb-10 relative"
       style="background: linear-gradient(180deg, rgba(191, 0, 255, 0.1) 0%, rgba(0, 0, 0, 0.9) 100%);
              border: 1px solid rgba(191, 0, 255, 0.4);
              box-shadow: 0 0 40px rgba(191, 0, 255, 0.3), inset 0 0 60px rgba(0, 0, 0, 0.5);">

    <h2 class="text-2xl font-bold mb-6 neon-purple animate-neon-pulse">Resultados Finales</h2>

    <div class="space-y-4">
      <% current_game.leaderboard.each_with_index do |player, index| %>
        <div class="flex items-center justify-between p-4 rounded-xl transition-all duration-300
                    <%= 'animate-bounce-in' if index == 0 %>"
             style="<% if index == 0 %>
                      background: linear-gradient(135deg, rgba(255, 45, 149, 0.2) 0%, rgba(191, 0, 255, 0.1) 100%);
                      border: 2px solid #ff2d95;
                      box-shadow: 0 0 25px rgba(255, 45, 149, 0.4), 0 0 50px rgba(255, 45, 149, 0.2);
                    <% elsif index == 1 %>
                      background: linear-gradient(135deg, rgba(0, 245, 255, 0.1) 0%, rgba(0, 0, 0, 0.6) 100%);
                      border: 1px solid rgba(0, 245, 255, 0.4);
                      box-shadow: 0 0 15px rgba(0, 245, 255, 0.3);
                    <% elsif index == 2 %>
                      background: linear-gradient(135deg, rgba(191, 0, 255, 0.1) 0%, rgba(0, 0, 0, 0.6) 100%);
                      border: 1px solid rgba(191, 0, 255, 0.3);
                      box-shadow: 0 0 10px rgba(191, 0, 255, 0.2);
                    <% else %>
                      background: rgba(30, 30, 30, 0.6);
                      border: 1px solid rgba(100, 100, 100, 0.2);
                    <% end %>"
             <% if index < 3 %>
             onmouseover="this.style.transform='scale(1.02)'"
             onmouseout="this.style.transform='scale(1)'"
             <% end %>>

          <div class="flex items-center gap-4">
            <!-- Position Medal/Number -->
            <span class="text-3xl <%= 'animate-neon-pulse' if index == 0 %>"
                  style="<% case index
                         when 0 %>filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.8));
                         <% when 1 %>filter: drop-shadow(0 0 8px rgba(192, 192, 192, 0.6));
                         <% when 2 %>filter: drop-shadow(0 0 6px rgba(205, 127, 50, 0.6));
                         <% end %>">
              <%= case index
                  when 0 then '&#x1F947;'.html_safe
                  when 1 then '&#x1F948;'.html_safe
                  when 2 then '&#x1F949;'.html_safe
                  else "<span class='text-text-muted font-bold'>#{index + 1}</span>".html_safe
                  end %>
            </span>

            <!-- Player Avatar -->
            <div class="w-12 h-12 rounded-full flex items-center justify-center font-bold text-white"
                 style="background: linear-gradient(135deg, #ff2d95 0%, #bf00ff 100%);
                        box-shadow: 0 0 15px rgba(255, 45, 149, 0.5);">
              <%= player.avatar_initials %>
            </div>

            <!-- Player Name -->
            <span class="font-bold text-lg <%= index == 0 ? 'neon-pink' : 'text-white' %>">
              <%= player.display_name %>
            </span>
          </div>

          <!-- Score -->
          <span class="text-3xl font-black <%= index == 0 ? 'neon-cyan animate-neon-pulse' : 'neon-purple' %>">
            <%= player.score %>
          </span>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="flex flex-col sm:flex-row gap-4 justify-center">
    <%= link_to "Nueva Partida", new_game_path,
                class: "neon-btn neon-btn-pink text-lg px-8 py-4 animate-neon-pulse" %>
    <%= link_to "Volver al Inicio", root_path,
                class: "px-8 py-4 rounded-xl font-bold text-lg transition-all duration-300",
                style: "background: rgba(0, 245, 255, 0.1);
                        border: 1px solid rgba(0, 245, 255, 0.4);
                        color: #00f5ff;
                        box-shadow: 0 0 15px rgba(0, 245, 255, 0.2);",
                onmouseover: "this.style.background='rgba(0, 245, 255, 0.2)'; this.style.boxShadow='0 0 25px rgba(0, 245, 255, 0.4)';",
                onmouseout: "this.style.background='rgba(0, 245, 255, 0.1)'; this.style.boxShadow='0 0 15px rgba(0, 245, 255, 0.2)';" %>
  </div>

  <!-- Neon floor reflection -->
  <div class="absolute bottom-0 left-0 right-0 h-32 pointer-events-none"
       style="background: linear-gradient(180deg, transparent 0%, rgba(191, 0, 255, 0.1) 50%, rgba(255, 45, 149, 0.15) 100%);
              filter: blur(20px);"></div>

  <!-- Animated bottom line -->
  <div class="absolute bottom-0 left-0 right-0 h-1"
       style="background: linear-gradient(90deg, #ff2d95, #bf00ff, #00f5ff, #bf00ff, #ff2d95);
              background-size: 200% 100%;
              animation: gradient-shift 3s linear infinite;
              box-shadow: 0 0 30px rgba(191, 0, 255, 0.6);"></div>
</div>

<style>
  @keyframes gradient-shift {
    0% { background-position: 0% 50%; }
    100% { background-position: 200% 50%; }
  }

  @keyframes confetti-fall {
    0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
    100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
  }
</style>

<div class="lobby-player-avatar aspect-square rounded-xl flex flex-col items-center justify-center p-2 relative transition-all duration-300 hover:scale-105"
     id="player_<%= player.id %>"
     style="background: linear-gradient(145deg, rgba(15, 15, 15, 0.9) 0%, rgba(25, 25, 25, 0.9) 100%);
            border: 2px solid <%= player.host? ? 'rgba(236, 72, 153, 0.5)' : 'rgba(168, 85, 247, 0.3)' %>;
            box-shadow: 0 0 15px <%= player.host? ? 'rgba(236, 72, 153, 0.3)' : 'rgba(168, 85, 247, 0.2)' %>;">

  <!-- Host Crown Badge -->
  <% if player.host? %>
    <div class="absolute -top-2 -right-2 w-6 h-6 rounded-full flex items-center justify-center text-xs"
         style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);
                box-shadow: 0 0 10px rgba(236, 72, 153, 0.5);">
      <span>&#x1F451;</span>
    </div>
  <% end %>

  <!-- Connection Status Indicator -->
  <% unless player.connected? %>
    <div class="absolute -top-1 -left-1 w-4 h-4 rounded-full flex items-center justify-center"
         style="background: rgba(239, 68, 68, 0.9);
                box-shadow: 0 0 8px rgba(239, 68, 68, 0.5);">
      <span class="text-[8px]">!</span>
    </div>
  <% end %>

  <!-- Avatar Circle -->
  <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center text-white font-bold text-sm sm:text-base mb-1 transition-all duration-300"
       style="background: linear-gradient(135deg, <%= player.host? ? '#ec4899, #db2777' : '#a855f7, #7c3aed' %>);
              box-shadow: 0 0 15px <%= player.host? ? 'rgba(236, 72, 153, 0.4)' : 'rgba(168, 85, 247, 0.4)' %>;">
    <%= player.avatar_initials %>
  </div>

  <!-- Player Name -->
  <span class="text-xs sm:text-sm text-center truncate w-full px-1 <%= player.connected? ? 'text-white' : 'text-text-muted' %>">
    <%= truncate(player.display_name, length: 10) %>
  </span>

  <!-- Score (if any) -->
  <% if player.score > 0 %>
    <span class="text-xs neon-cyan mt-0.5"><%= player.score %> pts</span>
  <% end %>

  <!-- Kick Button (Host only) -->
  <% if local_assigns[:show_kick] && show_kick %>
    <%= button_to kick_game_game_actions_path(player.game, player_id: player.id),
        method: :post,
        class: "absolute -bottom-1 left-1/2 -translate-x-1/2 px-2 py-0.5 rounded text-[10px] font-bold text-red-300 transition-all duration-300 opacity-0 group-hover:opacity-100 hover:bg-red-800/70",
        style: "background: rgba(127, 29, 29, 0.8); border: 1px solid rgba(239, 68, 68, 0.5);",
        data: { turbo_confirm: "Expulsar a #{player.display_name}?" } do %>
      <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    <% end %>
  <% end %>
</div>
